{% extends "base_site.html" %}
{% from "bootstrap/macros.html" import alert  %}
{% from "bootstrap/forms/macros.html" import field, input  %}

{% block css_extra %}
    <style></style>
{% endblock %}

{# Navbar is set in the app-specific override "base.html #}

{% block pre_content %}
{% endblock %}

{% block content %}
{% with pool = pools|first %}

{#<div class="row">
    <div class="span12">
        <div class="navbar">
        <div class="navbar-inner">
            <div class="container">
                <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
                <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </a>

                <!-- Be sure to leave the brand out there if you want it shown -->
                <a class="brand" href="#">pool {{ pool.name }}</a>

                <!-- Everything you want hidden at 940px or less, place within here -->
                <div class="nav-collapse">
                    <!-- .nav, .navbar-search, .navbar-form, etc -->
                </div>

            </div>
        </div>
        </div>
    </div>
</div>#}


<div class="row">
    <div class="span12">
        <ul class="breadcrumb">
            <li>
                <a href="#">home</a>
                <span class="divider">&gt;</span>
            </li>

            <li>
                <a href="#">pools</a>
                <span class="divider">&gt;</span>
            </li>

            <li>
                <a href="#">{{ pool.name }}</a>
                <span class="divider">/</span>
            </li>

            <li>
                <a href="#">tmp</a>
                <span class="divider">/</span>
            </li>

            <li class="active">
                <a href="#">vol0</a>
            </li>
        </ul>
    </div>
</div>

{% endwith %}

<div class="row">
    <div class="span3">
        <div class="well sidebar-nav">
            <ul class="nav nav-list dataset-list">
                {% for pool in pools %}
                <li class="nav-header">pool {{ pool.name }}</li>

                {% for dataset in pool.filesystems().filter(type='filesystem', enabled=True).order_by('name') %}
                    {% if pool.name == dataset.name %}
                        <li class="nav-header dataset"><a href="#">/</a></li>
                    {% else %}
                        <li class="dataset"><a href="#">/{{ dataset.path(1)|join('/') }}</a></li>
                    {% endif %}
                {% endfor %}

                <li><a href="#add-dataset-modal" class="add-dataset" data-toggle="modal">add dataset</a></li>
                {% endfor %}
            </ul>
        </div>
    </div>
    <div class="span9">
        <div id="dataset-info" style="padding-left: 10px"></div>
    </div>
</div>

<div class="modal fade hide" id="add-dataset-modal">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal">Ã—</button>
    <h3>Add Dataset</h3>
  </div>
  <div class="modal-body">
    <label><strong>Name:</strong> <input class="sprited"/></label>
  </div>
  <div class="modal-footer">
    <a href="#" class="btn" data-dismiss="modal">Close</a>
    <a href="#" class="btn btn-primary">Add</a>
  </div>
</div>

{% with pool = pools|first %}

<script type="text/javascript">
/* ______
 * status
 */
$(function() {

/*
 * dataset-list
 */

// Datasets
$(".dataset-list .dataset")
    .click(function() {
        $(this).parent().children(".active").removeClass("active", "fast");
        $(this).addClass("active");

        var url = "{{ url('solarsan.views.status_dataset', dataset='replacewithdataset') }}";
        url = url.replace(/replacewithdataset/i, $(this).find('a:first').html());

        $.ajax({type: "GET",
            url: url,
            context: $(this),
            }).done(function(data) { $("#dataset-info").html(data); });
    });
// Act as if the first dataset has been clicked
$(".dataset-list .dataset").first().click();


});
</script>

{% endwith %}
{% endblock %}

