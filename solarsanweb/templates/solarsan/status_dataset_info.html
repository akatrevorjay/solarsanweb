{% if action == "list" %}
<script type="text/javascript">


</script>

<div class="span9">
<div style="padding-left: 10px">

<div class="row">
    <div class="navbar">
        <div class="navbar-inner">
            <div class="container" style="width: auto;">
                <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </a>
                <a class="brand" href="#">{{ dataset.name }}</a>
                <div class="nav-collapse">
                    <ul class="nav">
                        <li class="active"><a href="#">Health</a></li>
                        {% set tabs = ['health', 'snapshots', 'cron', 'cluster', 'backup'] %}
                        {% for t in tabs %}
                        <li><a href="#">{{ t|capitalize }}</a></li>
                        {% endfor %}
                    </ul>

                    <ul class="nav pull-right">
                        {#<li><a href="#">Link</a></li>#}
                        {#<li class="divider-vertical"></li>#}

                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Services <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a href="#">Automatic Snapshot</a></li>
                                <li><a href="#">Online Backup</a></li>
                                {#<li class="divider"></li>
                                <li><a href="#">Separated link</a></li>#}
                            </ul>
                        </li>         
                    </ul>
                </div><!-- /.nav-collapse -->
            </div>
        </div><!-- /navbar-inner -->
    </div><!-- /navbar -->
</div>

<div class="row">
    <div id="dataset-info-content" class="hero-unit">
        content
    </div>
</div>

</div>
</div>

{% endif %}

{% if action == "health" %}
<pre>

	Pool "{{ dataset.pool.name }}"
		- Health: {{ dataset.pool.health }}


	Dataset:
       Used: {{ dataset.used }} / {{ dataset.available }}
		- By children: {{ dataset.usedbychildren }}
		- By snapshots: {{ dataset.usedbysnapshots }}
		
</pre>
{% endif %}

{% if action == "cluster" %}
    setup gluster mirror
{% endif %}

{% if action == "cron" %}
<script type="text/javascript">

$(".cronselect").each(function() {
	$(this).cron({
			onChange: function() {
				console.log('onchange');
		}});
});

</script>
<div style="min-height: 400px;">

<table>
	<tr>
		<td><h3>Automated Snapshots</h3></th>
		<td>Schedule</th>
	</tr>
	<tr>
		<td>
			<label for="cron_autosnap">Enable</label>
			<input type="checkbox" id="cron_autosnap" style="display: inline;"/>
		</td>
		<td>
			<div class="cronselect" style="display: inline;"></div>&nbsp;
			<a href="#" onclick="$(this).next().toggle().prev().toggle();">advanced</a>
			<input type="text" style="display: none;"/>
		</td>
	</tr>
	<tr>
		<td><h3>Integrated Online Backup</h3></td>
		<td>Schedule</td>
	</tr>
	<tr>
		<td>
			<label for="cron_backup">Enable</label>
			<input type="checkbox" id="cron_backup"/>
		</td>
		<td>
			<div class="cronselect" style="display: inline;"></div>&nbsp;
			<a href="#" onclick="$(this).next().toggle().prev().toggle();">advanced</a>
			<input type="text" style="display: none;"/>
		</td>
	</tr>
</table>

<div style="text-align: right">
	<input type="submit" value="Save" />
</div>

</div>
{% endif %}

{% if action == "backup" %}
<script type="text/javascript">

$(".online_backup").each(function() {
    // assign default values
    $("textarea, input", this).DefaultValue();

    // datasets drop
    $(".datasets", this).droppable({
            activeClass: "ui-state-hover",
            hoverClass: "ui-state-active",
            accept: ":not(.ui-sortable-helper)",
            drop: function( event, ui ) {
                $( this ).find( ".placeholder" ).remove();
                //console.log(ui);
                
                $( "<li></li>" ).text( ui.helper.text() ).button().css("padding", "5").appendTo(this);
                
                //$( "<div></div>" ).text( ui.draggable.find("a").text() ).button().appendTo( this );
            },
    }).sortable({
        items: "li:not(.placeholder)",
        tolerance: 'pointer',
        sort: function() {
            // gets added unintentionally by droppable interacting with sortable
            // using connectWithSortable fixes this, but doesn't allow you to customize active/hoverClass options
            $( this ).removeClass( "ui-state-default" );
        },
        //placeholder: "ui-state-highlight",
        //revert: true,
        //axis: 'x',
        //containment: 'parent',
    });
    //$(".datasets", this).disableSelection();
});

</script>

<div class="online_backup" style="padding: 10px;">
    enter in locsol backup key, drag and drop datasets from the left to backup<br />
    show graph with space available / remaining<br/>
    show backup status<br />
    <form>
        <input type="text" name="username" label="Username" />
        <textarea name="key" style="width: 100%" label="Online Backup Key"></textarea>
        <div class="datasets ui-state-default" style="width: 100%; height: 100px; overflow: hidden;" label="Datasets">
            <ul></ul>
        </div>
        <input type="submit" value="Save"/>
    </form>
</div>
{% endif %}

{% if action == "snapshots" %}

<table id="list1"></table>
<div id="pager1"></div>

<script type="text/javascript">

$("#list1").jqGrid({ url: '{{ url('solarsan.views.status_dataset_info', dataset=dataset.name, action="snapshots_xml_jqgrid") }}',
    datatype: "xml",
    colNames: ['Name', 'Created', 'Used', 'Avail' ],
    colModel: [
        {name:'name', index:'name'},
        {name:'created', index:'created', width: 110},
        {name:'used', index:'used', width: 25},
        {name:'available', index:'available', width: 25}, ],
    rowNum: 20, rowList: [10,20,30],
    autowidth: true,
    height: 250,
    pager: '#pager1',
    sortname: 'name',
    viewrecords: true,
    sortorder: "desc"}).navGrid('#pager1', {edit:false, add:true, del:true});

</script>
{% endif %}

{% if action == "snapshots_xml_jqgrid" %}
<rows>
    {% for snapshot in dataset.snapshots|sort(attribute='name') %}
    <row>
        <cell><![CDATA[{{ snapshot.basename }}]]></cell>
        <cell>{{ snapshot.creation }}</cell>
        <cell>{{ snapshot.used }}</cell>
        <cell>{{ dataset.available }}</cell>
    </row>
    {% endfor %}
</rows>
{% endif %}
